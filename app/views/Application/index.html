#{extends 'main.html' /}
#{set title:'beautify.me - Welcome!' /}

#{set 'moreStyles'}
<link rel="stylesheet" media="screen" href="http://smoothdivscroll.com/css/smoothDivScroll.css"/>
    #{stylesheet 'scroller.css'/}
#{/set}

<div id="media">
    <video autoplay id="v" style="width:800px; height:700px; display: none"></video>
    <div id="container"></div>
</div>


<div id="ads">

    <button id="go">Take a photo!</button>
    <img id="imp" style="display:none;"/>
    <img src="@{'/public/images/side.png'}"/>
</div>


<div id="items">
    <div id="makeMeScrollable">
    #{list items:accessoryList, as:'accessory'}

        <a href="#"><img height="100" width="100" src="@{Accessories.getPic(accessory.id)}"/></a>

    #{/list}
    </div>
</div>

<script src="http://smoothdivscroll.com/js/jquery-ui-1.8.23.custom.min.js" type="text/javascript"></script>
<script src="http://smoothdivscroll.com/js/jquery.mousewheel.min.js" type="text/javascript"></script>
<script src="http://smoothdivscroll.com/js/jquery.smoothdivscroll-1.3-min.js" type="text/javascript"></script>
<script type="text/javascript">
    // Initialize the plugin with no custom options
    $(document).ready(function () {
        // None of the options are set
        $("div#makeMeScrollable").smoothDivScroll({});
    });
</script>


<script src="@{'/public/javascripts/kinetic-v4.5.4.min.js'}"></script>
<script src="@{'/public/javascripts/main.js'}"></script>
<script>
    var stage = new Kinetic.Stage({
        container: 'container',
        width: width,
        height: height
    });
    layer = new Kinetic.Layer();
    stage.add(layer);

</script>
<script src="@{'/public/javascripts/video-stream.js'}"></script>
<script src="@{'/public/javascripts/canvas-control.js'}"></script>
<script defer="defer">

    var target = new Kinetic.Image({
        name: 'video',
        x: 0,
        y: 0,
        width: width,
        height: height,
        image: v});

    layer.add(target);
    setVideo(v, target);

    function setVideo(video, target) {
        target.setImage(video);
        stage.draw();
        setTimeout(setVideo, 20, video, target);
    }

    $("#items img").click(function () {
        loadImage($(this).attr('src'));
    });

    $("#go").click(function () {

        var canvas = layer.getCanvas().getElement();
        var dataURL = canvas.toDataURL();
        document.getElementById('imp').src = dataURL;

        $("#imp").show();

    });

</script>
